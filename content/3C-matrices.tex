\section{Matrices}
\subsection{Representing a Liner Map by a Matrix}

%3.31
\setcounter{thm}{30}
\begin{mydef}[matrix of a linear map, $\mmatrix(T)$]
  \label{def: matrix of a linear map}
  Let $T \in \linmap (V,W)$ and let $v_1, \dots, v_n$ be a basis of $V$ and let $w_1, \dots, w_m$ be a basis of $W$. The \qt{matrix of $T$} with respect to these bases is the $m$-by-$n$ matrix $\mmatrix(T)$ whose entries $A_{j,k}$ are defined by
  \begin{equation}
    T v_k = A_{1,k} w_1 + \cdots + A_{m,k} w_m \equiv \sum_{j=1}^{m} A_{j,k} w_j.
  \end{equation}
  If the bases are not clear from the context, one writes $\mmatrix(T, (v_1, \dots, v_n),(w_1, \dots, w_m))$. One remembers how to construct $\mmatrix(T)$, if one writes the bases on left hand side and on top of the matrix. It looks as follows:
  \begin{equation}
    \mathcal{M} (T) :\equiv
      \begin{blockarray}{cccccc}
                 & v_1 & \cdots & v_k     & \cdots & v_n \\
        \begin{block}{c(ccccc)}
          w_1    &     &        & A_{1,k} &        &     \\
          \vdots &     &        & \vdots  &        &     \\
          w_m    &     &        & A_{m,k} &        &     \\
        \end{block}
      \end{blockarray}
  \end{equation}
\end{mydef}

\subsection{Addition and Scalar Multiplication of Matrices}

% 3.35
\setcounter{thm}{34}
\begin{thm}[matrix of the sum of linear maps]
  $\mmatrix(S+T) = \mmatrix(S) + \mmatrix(T)$ for $S, T \in \linmap (V,W)$
\end{thm}

% 3.38
\setcounter{thm}{37}
\begin{thm}[matrix of a scalar times a linear map]
  $\mmatrix(\lambda T) = \lambda \mmatrix(T)$ for $\lambda \in \myF$ and $T \in \linmap (V,W)$
\end{thm}

\begin{mydef} [notation $\myF^{m,n}$]
  $\myF^{m,n}$ denotes the set of all $m$-by-$n$ matrices with entries in $\myF$, where $m,n \in \nat$
\end{mydef}

\begin{thm} % no []
  \label{thm: the dimension of the vector space of all m by n matrices is mn}
  $\myF^{m,n}$ is a vector space with $\dim \myF^{m,n}=mn$.
\end{thm}


\subsection{Matrix Multiplication}

Let $v_1, \ldots, v_n$ be a basis of $V$, $w_1, \ldots, w_m$ be a basis of $W$ and $u_1, \ldots, u_p$ be a basis of $U$.
Consider the linear maps $T: U \to V$ and $S: V \to W$. The composition $ST$ is a linear map from $U$ to $W$. Is it the case that
\begin{equation}
  \mmatrix(ST) = \mmatrix(S)  \mmatrix(T) \; {\mathlarger ?}
\end{equation}

%One can choose a definition of matrix multiplication that forces this question to have a positive answer.

Later on, matrix multiplication will be defined accordingly such that this question has a positive answer.
For now, let $A := \mmatrix(S)\in \myF^{m,n}$ and $B := \mmatrix(T)\in \myF^{m,p}$. Now have a look at the matrices of $S$ and $T$:
\begin{equation}
  A := \mathcal{M} (S) =
  \begin{blockarray}{cccccc}
    & v_1 & \cdots & v_r     & \cdots & v_n \\
    \begin{block}{c(ccccc)}
      w_1    &     &        & A_{1,r} &        &     \\
      \vdots &     &        & \vdots  &        &     \\
      w_j    &     &        & A_{j,r} &        &     \\
      \vdots &     &        & \vdots  &        &     \\
      w_m    &     &        & A_{m,r} &        &     \\
    \end{block}
  \end{blockarray},
  \quad
  B := \mathcal{M} (T) =
  \begin{blockarray}{cccccc}
    & u_1 & \cdots & u_k     & \cdots & u_p \\
    \begin{block}{c(ccccc)}
      v_1    &     &        & B_{1,k} &        &     \\
      \vdots &     &        & \vdots  &        &     \\
      v_r    &     &        & B_{r,k} &        &     \\
      \vdots &     &        & \vdots  &        &     \\
      v_n    &     &        & B_{n,k} &        &     \\
    \end{block}
  \end{blockarray}
\end{equation}

For $1 \leq k \leq p$, we have
\begin{equation}
  \begin{aligned}
    (ST) u_k
    = S (Tu_k)
    = S \left ( \sum_{r=1}^{n} B_{r,k} v_r \right )
    =  \sum_{r=1}^{n} B_{r,k} S v_r
    =  \sum_{r=1}^{n} B_{r,k} \sum_{j=1}^{m} A_{j,r}  w_j
    =  \sum_{j=1}^{m} \left( \sum_{r=1}^{n} A_{j,r}  B_{r,k} \right) w_j
  \end{aligned}
\end{equation}

\begin{minipage}{\linewidth-40pt}
  Thus $\mmatrix(ST)$ is  the $m$-by-$p$ matrix whose entry in row $j$, column $k$ equals
  $\sum_{r=1}^{n} A_{j,r}  B_{r,k}.$
\begin{equation}
  \mathcal{M} (ST) =
  \begin{blockarray}{cccccc}
             & u_1 & \cdots &  u_k      & \cdots & u_p \\
    \begin{block}{c(ccccc)}
      w_1    &     &        &
        \sum_{r=1}^{n} A_{1,r}  B_{r,k} &        &     \\
      \vdots &     &        &  \vdots   &        &     \\
      w_j    &     &        &
        \sum_{r=1}^{n} A_{j,r}  B_{r,k} &        &     \\
      \vdots &     &        &  \vdots   &        &     \\
      w_m    &     &        &
        \sum_{r=1}^{n} A_{m,r}  B_{r,k} &        &     \\
    \end{block}
  \end{blockarray}
\end{equation}
\end{minipage}


%3.41
\setcounter{thm}{40}
\begin{mydef} [matrix multiplication]
  \label{def: matrix multiplication}
  Let $A \in \myF^{m,n}$ and $B \in \myF^{n,p}$. Then $AB \in \myF^{m,p}$ whose entry in row $j$, column $k$, is given by the equation
  \begin{equation}
    (AB)_{j,k} :\equiv \sum_{r=1}^{n} A_{j,r} B_{r,k}.
  \end{equation} %for $A\in \myF^{m,n}$, $B\in \myF^{n,p}$, $AB \in \myF^{m,p}$

  \begin{minipage}{\linewidth}
    The octave code for calculating the entry $j,k$ of the result of $A, B$ with the \qt{sum-scheme} like above looks as follows

    \octave{standard_matrix_mult.m}
  \end{minipage}
\end{mydef}

% 3.43
\setcounter{thm}{42}
\begin{thm}[matrix of product of linear maps]
  If $T \in \linmap(U,V)$ and $S\in \linmap(V,W)$, then
  \begin{equation}
    \mmatrix(ST) = \mmatrix(S) \mmatrix(T).
  \end{equation}
\end{thm}
\begin{prf}
  See at the beginning of the sub-subsection.
\end{prf}

\begin{mydef} [notation: $A_{j, \mathsmaller{\bullet}}, A_{\mathsmaller{\bullet}, k}$ ] Let $A\in \myF^{m,n}$. Then
  \begin{itemize}
    \item If $1 \leq j \leq m$, then $A_{j, \mathsmaller{\bullet}}$ denotes the $1$-by-$n$ matrix consisting of row $j$ of $A$.
    \item If $1 \leq k \leq n$, then  $A_{\mathsmaller{\bullet}, k}$ denotes the $m$-by-$1$ matrix consisting of the column $k$ of $A$.
  \end{itemize}
\end{mydef}

% 3.46
\setcounter{thm}{45}
\begin{thm} [entry of matrix product equals row times column]
  If $A \in \myF^{m,n}$ and $B \in \myF^{n,p}$, then we have for $1 \leq j \leq m$ and $1 \leq k \leq p$
  \begin{equation}
    (AB)_{j,k} = A_{j, \mathsmaller{\bullet}} B_{\mathsmaller{\bullet}, k}
  \end{equation}

  \begin{minipage}{\linewidth}
    The octave code for multiplying rows and columns directly at entry $j,k$ looks as follows

    \octave{row_times_column_matrix_mult.m}
  \end{minipage}
\end{thm}

% 3.48
\setcounter{thm}{47}
\begin{thm}[column of matrix product equals matrix times column]
  If $A \in \myF^{m,n}$ and $B \in \myF^{n,p}$, then we have for $1 \leq k \leq p$
  \begin{equation}
    (AB)_{\mathsmaller{\bullet}, k} = AB_{\mathsmaller{\bullet}, k}
  \end{equation}

  In other words, column $k$ of $AB$ equals $A$ times column $k$ of $B$. The octave code looks as follows

  \octave{matrix_times_columns_matrix_mult.m}

\end{thm}

\setcounter{thm}{49}
\begin{thm}
%  $b=\left(\begin{matrix}b_1\\ \vdots \\ b_n \end{matrix}\right)
  Suppose $A \in \myF^{m,n}$ and  $b = (b_1, \ldots, b_n)^{t}\in \myF^{n,1}$. Then
  \begin{equation}
    Ab = b_1 A_{\mathsmaller{\bullet}, 1} + \dots + b_n A_{\mathsmaller{\bullet},n}. \quad $See \ref{def: transpose} for the definition of $^t.
  \end{equation}
\end{thm}

\begin{thm}[matrix multiplication as linear comb. of columns or rows]
  \phantom{.} Let $C\in\myF^{m,c}$ and $R\in\myF^{c,n}$.

  \bfemph{Column-wise:} If $k \in \{1,\ldots,n\}$, then column $k$ of $CR\in \myF^{m,n}$ is a linear combination of the columns of $C$, with the coefficients of this linear combination coming from column $k$ of $R$ [$R_{\mathsmaller{\bullet}, k}$].
  \begin{equation}
    \begin{aligned}
      &CR = \\
      &\left(
      \underbrace{
      \left(
       \left(
          \begin{matrix}C_{1,1}
            \\ \vdots \\ C_{m,1}
          \end{matrix}
        \right) R_{1,1}
        + \cdots +
        \left(
          \begin{matrix}C_{1,c}
            \\ \vdots \\ C_{m,c}
          \end{matrix}
        \right) R_{c,1}
        \right)
      }_{\text{$1$st column}}
      \ldots
      \underbrace{
        \boxed{
          \left(
            \begin{matrix}C_{1,1}
              \\ \vdots \\ C_{m,1}
            \end{matrix}
          \right) R_{1,k}
          + \cdots +
          \left(
            \begin{matrix}C_{1,c}
              \\ \vdots \\ C_{m,c}
            \end{matrix}
          \right) R_{c,k}
        }
      }_{\text{$k$th column}}
      \ldots
      \underbrace{
        \left(
          \left(
            \begin{matrix}C_{1,1}
              \\ \vdots \\ C_{m,1}
            \end{matrix}
          \right) R_{1,n}
          + \cdots +
          \left(
            \begin{matrix}C_{1,c}
              \\ \vdots \\ C_{m,c}
            \end{matrix}
          \right) R_{c,n}
        \right)
      }_{\text{last column}}
      \right)
    \end{aligned}
  \end{equation}

\begin{minipage}{\linewidth}
  The octave\-/code for column-wise multiplication looks like follows.

  \octave{column_wise_matrix_mult.m}
\end{minipage}

  \bfemph{Row-wise:} If $j\in \{1, \ldots, m\}$, then row $j$ of $CR$ is a linear combination of the rows of $R$, with the coefficients of this linear combination comming from row $j$ of $C$ [$C_{j,\mathsmaller{\bullet}}$]
  \begin{equation}
    CR =
    \left(
      \begin{matrix}
        C_{1,1} (R_{1,1}, \ldots, R_{1,n}) + C_{1,2} (R_{2,1}, \ldots, R_{2,n}) + \cdots + C_{1,c} (R_{c,1}, \ldots, R_{c,n}) \\
        C_{2,1} (R_{1,1}, \ldots, R_{1,n}) + C_{2,2} (R_{2,1}, \ldots, R_{2,n}) + \cdots + C_{2,c} (R_{c,1}, \ldots, R_{c,n}) \\
        \vdots \\
        C_{j,1} (R_{1,1}, \ldots, R_{1,n}) + C_{j,2} (R_{2,1}, \ldots, R_{2,n}) + \cdots + C_{j,c} (R_{c,1}, \ldots, R_{c,n}) \\
        \vdots \\
        C_{m,1} (R_{1,1}, \ldots, R_{1,n}) + C_{m,2} (R_{2,1}, \ldots, R_{2,n}) + \cdots + C_{m,c} (R_{c,1}, \ldots, R_{c,n}) \\
      \end{matrix}
    \right)
  \end{equation}

  \begin{minipage}{\linewidth}
    The octave\-/code for row-wise multiplication looks like follows.

    \octave{row_wise_matrix_mult.m}
  \end{minipage}

\end{thm}

\subsection{Column-Row Factorization and Rank of a Matrix}

% 3.52
\setcounter{thm}{51}
\begin{mydef}[column rank, row rank]
  For $A \in \myF^{m,n}$, the \qt{column rank} of $A$ is the dimension of the span of the columns of $A$ in $\myF^{m,1}$. The \qt{row rank} of $A$ is the dimension of the span of the rows of $A$ in $\myF^{1,n}$.
\end{mydef}

% 3.54
\setcounter{thm}{53}
\begin{mydef}[transpose, $A^t$]
  \label{def: transpose}
  The \qt{transpose} of a matrix $A\in \myF^{m,n}$, denoted by $A^t\in \myF^{n,m}$, is obtained by interchanging rows and columns. Its entries are given by the equation
  \begin{equation}
    \left( A^{t} \right)_{k,j} = A_{j,k} \quad \forall k \in \{1, \ldots, m\}, j \in \{1, \ldots, n\}.
  \end{equation}
\end{mydef}

% 3.56
\setcounter{thm}{55}
\begin{thm}[column-row factorization]
  Suppose $A \in \myF^{m,n}$ with column rank $c \geq 1.$ Then there exists $C\in \myF^{m,c}$ and $R\in \myF^{c,n}$ such that
  \begin{equation}
    A = CR.
  \end{equation}
\end{thm}

 % 3.57}
\begin{thm}[column rank and row rank]
  If $A\in \myF^{m,n}$, then column rank of $A$ $=$ row rank of $A$. This leads to the next definition.
\end{thm}

\begin{mydef} [rank]
  The \qt{rank} of a matrix $A \in  \myF^{m,n}$ is the column rank of $A$.
\end{mydef}
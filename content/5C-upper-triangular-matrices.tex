\section{Upper-Triangular Matrices}

\setcounter{thm}{38}
\begin{thm} [conditions for upper-triangular matrix]
  \label{conditions for upper-triangular matrix}
  If $T \in \linmap (V)$ and $v_1, \dots, v_n$ is a basis of $V$. Then the following are equivalent.
  \begin{enumerate}[label=\textbf{(\alph*)}]
    \item The matrix of $T$ with respect to $v_1, \dots, v_n$ is upper triangular.
    \item $\myspan{v_1, \dots, v_k}$ is invariant under $T$ $\quad \forall k \in \{ 1, \dots, n\}$
    \item $T v_k \in \myspan{v_1, \dots, v_k} \quad \forall k \in \{1, \dots, n\}$
  \end{enumerate}
\end{thm}
\begin{proof}
  First suppose (a) holds. So like in \ref{def: matrix of a linear map}, the matrix $\mmatrix(T)$ looks like this

  \begin{minipage}{\linewidth}
  \begin{equation}
  \mathcal{M} (T) =
  \begin{blockarray}{cccccc}
    & v_1     & \cdots & v_j      & \cdots & v_n     \\
    \begin{block}{c(ccccc)}
      v_1    & A_{1,1} & \cdots & A_{1,j}  & \cdots & A_{1,n} \\
      \vdots &         & \ddots & \vdots   &   *    & \vdots  \\
      \vdots &         &        & A_{j,j}  &   *    & \vdots  \\
      \vdots &         &        &          & \ddots & \vdots  \\
      v_n    &         &        &          &        & A_{n,n} \\
    \end{block}
  \end{blockarray}
  \end{equation}
  \end{minipage}


  Using a modified version of the equation in \ref{def: matrix of a linear map}, we have for $j\in \{1, \ldots n \}$
  \begin{equation}
    T v_j = A_{1,j} v_j + \cdots + A_{j,j} v_j = \sum_{l=1}^{j} A_{l,j} v_j
  \end{equation}

  which implies
  \begin{equation}
    T v_j \in \myspan{v_1, \ldots, v_j}
  \end{equation}

  Now suppose $j, k \in \{1 \ldots n \}$ such that $j \leq  k.$ Because
  \begin{equation}
    \myspan{v_1, \ldots, v_j} \subseteq \myspan{v_1, \ldots, v_k}
  \end{equation}

  we see that
  \begin{equation}
    T v_j \in \myspan{v_1 \ldots v_k} \mytext{for each} j \in \{1, \ddd, k\}.
  \end{equation}

  Thus $\myspan{v_1 \ldots v_k}$ is invariant under $T$, completing the proof that (a) implies (b)

  Now suppose (b) holds, so $\myspan{v_1, \ldots, v_k}$ is invariant under $T$ for each $k \in \{1 \ldots n\}.$

  In particular
  \begin{equation}
    T v_k \in \myspan{v_1, \ldots, v_k} \quad \forall k \in \{1 \ldots n\}
  \end{equation}

  Thus (b) implies (c).

  Now suppose (c) holds, so $T v_k \in \myspan{v_1, \ldots, v_k} \quad \forall k \in \{1 \ldots n\}$, which is the same as
  \begin{equation}
    T v_k = a_1 v_1 + \cdots + a_k v_k \where a_1, \dots a_k \in \myF
  \end{equation}

  Hence all the entries under the diagonal of $\mmatrix (T)$ are $0$, because $v_1, \ldots, v_n$ are linearly independent and we can not choose another representation for $T v_k$ in respect to that list. Thus $\mmatrix(T)$ is an upper-triangular matrix, completing the proof that (c) implies (a).

  Afterall we have shown that (a) $\implies$ (b) $\implies$ (c) $\implies$ (a)
  %TODO: comma?
\end{proof}

\begin{thm}[equation satisfied by operator with upper-triangular matrix]
  \label{thm: equation satisfied by operator with upper triangular matrix}
  Suppose $T\in \linmap(V)$ and $V$ has a basis with respect to which $T$ has an upper-triangular matrix with diagonal entries $\lambda_1, \dots, \lambda_n$.
  \begin{equation}
    \implies (T-\lambda_1I) \cdots (T-\lambda_nI)=0
  \end{equation}

  Note that this theorem does not mention anything about eigenvalues.
\end{thm}
\begin{prf}
  Let $A :\equiv \mmatrix(T)$. Let $v_1, \ldots, v_n$ denote a basis of $V$ with respect to which $T$  has an upper-triangular matrix with diagonal entries $\lambda_1, \ldots, \lambda_n$.

  \begin{minipage}{\linewidth}
  \begin{equation}
    A = \mmatrix(T)
    =
    \left( {\begin{array}{ccc}
        \lambda_1 &         &  * \\
                  &  \ddots &    \\
        0         &         & \lambda_n
    \end{array} } \right)
    =
    \begin{blockarray}{(cccc)}
       \lambda_1&  A_{1,2}  &  \cdots &  A_{1,n} \\
                & \lambda_2 &     *   &  A_{2,n} \\
                &           &  \ddots &  \vdots  \\
                &           &         & \lambda_n
    \end{blockarray}
  \end{equation}
  \end{minipage}

  Then
  \begin{equation}
    \label{i-need-a-ref}
    T v_1 = \lambda_1 v_1 \iff (T-\lambda_1 I)  v_1 = 0,
  \end{equation}

  which implies that
  \begin{equation}
\begin{aligned}
    &(T-\lambda_1 I)(T-\lambda_2 I)  v_1 =0, \\
    &(T-\lambda_1 I)(T-\lambda_2 I)(T-\lambda_3 I)  v_1 =0, \\
    &\ldots \text{ or more generally speaking:} \\
    &(T-\lambda_1 I) \cdots (T-\lambda_m I) v_1 = 0,
     \mytext{for} m = 1, \ldots, n.
\end{aligned}
  \end{equation}
  (Using commutativity for linear maps after multiplying both sides of the equation with anything.)
  \bigbreak

  Note that $(T-\lambda_2 I) v_2 \in \myspan{v_1}$ because $T v_2 = A_{1,2} v_1 + \lambda_2 v_2$. Thus using \eqref{i-need-a-ref}
  \begin{equation}
    \begin{aligned}
      \label{i-also-need-a-ref}
      (T- \lambda_1 I) (T- \lambda_2 I) v_2
      &= (T- \lambda_1 I) A_{1,2}v_1  \\
      &= A_{2,1}(T- \lambda_1 I) v_1  \\
      &=0.
    \end{aligned}
  \end{equation}

  which implies that
  \begin{equation}
    \begin{aligned}
        &(T-\lambda_1 I) (T-\lambda_2 I)(T-\lambda_3)v2 = 0 \\
        &(T-\lambda_1 I) (T-\lambda_2 I)(T-\lambda_3)(T-\lambda_4)v2 = 0 \\
        &\ldots \text{ or more generally speaking:} \\
        &(T-\lambda_1 I) \cdots (T-\lambda_m I) v_2 = 0, \mytext{for} m = 2, \ldots, n.
    \end{aligned}
  \end{equation}
  (Using commutativity for linear maps after multiplying both sides of the equation with anything.)
  \bigbreak

  Note that $(T-\lambda_3 I) v_3 \in \myspan{v_1, v_2}$ because $T v_3 = A_{1,3} v_1 +   A_{2,3} v_2 + \lambda_3 v_3$. \\
  Thus using \eqref{i-need-a-ref} and \eqref{i-also-need-a-ref}, we get
  \begin{equation}
    \begin{aligned}
      (T- \lambda_1 I) (T- \lambda_2 I) (T- \lambda_3 I)v_3
      &=(T- \lambda_1 I) (T- \lambda_2 I)(A_{1,3} v_1 +   A_{2,3} v_2)  \\
        &= (T- \lambda_1 I)A_{1,3} v_1(T- \lambda_2 I)+(T- \lambda_1 I)(T- \lambda_2 I)A_{2,3} v_2 \\
        &= A_{1,3}(T- \lambda_1 I) v_1(T- \lambda_2 I)+A_{2,3}(T- \lambda_1 I)(T- \lambda_2 I) v_2 \\
            &= 0
    \end{aligned}
  \end{equation}

  which implies that
  \begin{equation}
    (T-\lambda_1 I) (T-\lambda_2 I) \cdots (T-\lambda_m I) v_3= 0, \mytext{for} m = 3, \ldots, n.
  \end{equation}
  (Using commutativity for linear maps after multiplying both sides of the equation with anything.)
  \bigbreak

  Continuing this pattern, we see that
  \begin{equation}
    (T-\lambda_1 I) \cdots (T- \lambda_n I) v_k = 0 \quad \forall k \in \{ 1\ldots n \}
  \end{equation}

  Thus $(T-\lambda_1 I) \cdots (T- \lambda_n I)$ is the $0$ operator because it is $0$ on each vector in a basis of $V$.
\end{prf}

\begin{example-non}[octave, matlab]
  To test this  in octave or matlab, type:

  \begin{center}
    \begin{minipage}{\linewidth}
      \addtolength{\linewidth}{-7em}
      \begin{lstlisting}[
        aboveskip=0.5em,
        frame=single,
        numbers=left,
        style=Matlab-bw,
        basicstyle=\scriptsize\ttfamily]
  A=rand(4,4); I=eye(4); T=triu(A);
  ZERO=(T-T(1,1)*I)*(T-T(2,2)*I)*(T-T(3,3)*I)*(T-T(4,4)*I)
      \end{lstlisting}
      \addtolength{\linewidth}{+7em}
    \end{minipage}
  \end{center}

  which should yield a $4$-by-$4$ zero\-/matrix.
\end{example-non}

\begin{thm}[determination of eigenvalues from upper-triangular matrix]
  \label{thm:determination-of-eigenvalue-from-upper-triangular-matrix}
  Suppose $T\in \linmap(V)$ has an upper\-/triangular matrix with respect to some basis of $V$. Then the eigenvalues of $T$ are precisely the entries on the diagonal of that upper-triangular matrix.

\end{thm}
\begin{prf}
  Let $v_1, \ldots, v_n$ denote a basis of $V$ with respect to which $T$ has an upper-triangular matrix with diagonal entries $\lambda_1, \ldots, \lambda_n$.
  \begin{equation}
    \mmatrix(T) =
    \left( {\begin{array}{ccc}
        \lambda_1 &         &  * \\
        &  \ddots &    \\
        0      &         & \lambda_n
    \end{array} } \right)
  \end{equation}

  Because $T v_1 = \lambda_1 v_1$, we see that $\lambda_1$ is an eigenvalue of $T$.
  Suppose $k \in \{2, \ddd, n\}.$

  Then $(T-\lambda_k I) v_k \in \myspan{v_1, \ldots, v_{k-1}},$ because
  \begin{equation}
    T v_k = \mmatrix(T)_{1,k} v_1 + \mmatrix(T)_{2,k}v_2 + \cdots \mmatrix(T)_{k-1,k} v_{k-1} + \lambda_k v_k.
  \end{equation}

  Thus $T-\lambda_k I$ maps $\myspan{v_1, \ldots, v_k}$ into $\myspan{v_1, \ldots, v_{k-1}}$.

  Because
  \begin{equation}
    \dim \myspan{v_1, \ldots, v_k} = k \myand \dim \myspan{v_1, \ldots, v_{k-1}} = k-1,
  \end{equation}

  this implies that $T-\lambda_k I$, which is restricted to $\myspan{v_1, \ldots, v_{k-1}}$, is not injective by \ref{thm: linear-map-to-a-lower-dimensional-space-is-not-injective}. This theorem states that a linear map to a lower dimensional space is not injective. Thus
  \begin{equation}
    \exists v \in \myspan{v_1, \ldots, v_n}: v\neq0$ and $(T-\lambda_k I)v=0.
  \end{equation}
  Thus $\lambda_k$ is an eigenvalue of $T$ with eigenvector $v$. Hence we have shown that every entry of the diagonal of $\mmatrix(T)$ is an eigenvalue of $T$.

  To prove $T$ has no other eigenvalues, let
  \begin{equation}
    \begin{aligned}
      q &:\equiv (z-\lambda_1) \cdots (z-\lambda_2). \\
      &\implies q(T) = 0 \mytext{by \ref{thm: equation satisfied by operator with upper triangular matrix}}
    \end{aligned}
  \end{equation}

  Hence $q$ is a polynomial multiple of the minimal polynomial of $T$ by \ref{thm: every zero polynomial is a multiple of the minimal polynomial}. Thus every zero of the minimal polynomial is a zero of $q$.
  Because the zeros of the minimal polynomial of $T$ are the eigenvalues of $T$ by \ref{thm: eigenvalues are the zeros of the minimal polynomial}, this implies that every eigenvalue of $T$ is a zero of $q$. Hence the eigenvalues of $T$ are all contained in the list $\lambda_1, \ldots, \lambda_n$.
\end{prf}


\setcounter{thm}{43}
\begin{thm}[necessary and sufficient condition to have an upper-triangular-matrix]
  \label{thm: necessary and sufficient condition to have an upper-triangular-matrix}
  Suppose $T\in \linmap(V)$, $\dim V$ $\neq$ $\infty$.
  Then $T$ has an upper-triangular matrix $\mmatrix(T)$ in respect to some basis of $V$ $\iff$ The minimal polynomial of $T$ equals $(z-\lambda_1) \cdots (z-\lambda_m)$, where $\lambda_1, \dots \lambda_m \in \myF.$

\end{thm}
\begin{prf}
  \qt{$\Rightarrow$-direction:} Suppose $T$ has an upper-triangular matrix with respect to some basis of $V$. Let $\alpha_1, \ddd, \alpha_n$ denote the diagonal entries of that matrix.
  \begin{equation}
  \mmatrix(T) =
  \left( {\begin{array}{ccc}
      \alpha_1 &         &  \mathlarger{*} \\
      &  \ddots &    \\
      0      &         & \alpha_n
  \end{array} } \right)
  \end{equation}

  Let $q\in \polyn(\myF)$, \st
  \begin{equation}
    q(z) :\equiv (z-\alpha_1) \cdots (z-\alpha_n).
  \end{equation}

  Then $q(T) = 0$, by \ref{thm: equation satisfied by operator with upper triangular matrix}. $\implies$ $q$ is a polynomial multiple of the minimal polynomial of $T$. $\implies$ The minimal polynomial of $T$ equals $(z-\lambda_1) \cdots (z-\lambda_m)$ for some $\lambda_1, \ddd, \lambda_m \in \myF$ with $\{ \lambda_1 , \ddd, \lambda_m \} \subseteq \{\alpha_1, \ddd, \alpha_n \}.$

  \qt{$\Leftarrow$-direction:} Let $p \in \polyn(\myF)$ be the minimal polynomial of $T$ \st
  \begin{equation}
    \label{eq: definition of the minimal polynomial}
    p(z) :\equiv (z-\lambda_1) \cdots (z-\lambda_m) \mytext{for some} \lambda_1, \ddd, \lambda_m \in \myF.
  \end{equation}

  If $m=1$, then $z-\lambda_1$ is the minimal polynomial of $T$. $\implies$ $T=\lambda_1I$, which implies that the matrix of $T$ is the identity matrix times a scalar.
  \begin{equation}
    \mmatrix(T) = \lambda_1 I_{\dim V}
  \end{equation}

  So $\mmatrix(T)$ is upper triangular. Therefore we are ready to use induction over $m$.

  Now suppose $m > 1$ and the result holds for all smaller integers /  polynomials. Let
  \begin{equation}
    U :\equiv \myrange(T - \lambda_m I)
  \end{equation}

  In this case, $U$ is invariant under $T$, because of \ref{thm: null space and range of p(T) are invariant under T} where $p(z)$ would be $z-\lambda_m$. Thus $\left. T \right |_{U}$ is an operator on $U$.
  If $u \in U$, then $u=(T - \lambda_m I) v$ for some $v \in V$. For this arbitrary $u$ and corresponding $v$ it holds that
  \begin{equation}
    (T-\lambda_1 I) \cdots (T-\lambda_{m-1}I)u=(T-\lambda_1I)\cdots(T-\lambda_{m-1}I)(T-\lambda_mI)v=0, $ because of \eqref{eq: definition of the minimal polynomial}.$
  \end{equation}

  Hence $(T-\lambda_1 I) \cdots (T-\lambda_{m-1}I)$ is a multiple of the minimal polynomial of $\left. T \right |_{U}$, by \ref{thm: every zero polynomial is a multiple of the minimal polynomial}. With other words: It is the product of at most $m-1$ terms of the form $z-\lambda_k \quad \forall k \in \{1, \ddd, m-1 \}$.

  By the induction hypothesis, there is a basis $u_1, \ddd, u_M$ of $U$ with respect to which $\left. T \right |_{U}$ has an upper-triangular matrix. Using \ref{conditions for upper-triangular matrix}
  \begin{equation}
    \label{eq: first eq for T v_k}
    \implies \forall k \in \{ 1, \ddd, M \}:
    T u_k = ( \left. T \right|_{U})(u_k)
    \in \myspan{u_1, \ddd, u_k}.
  \end{equation}

  Extend $u_1, \ddd, u_m$ to a basis $u_1, \ddd, u_M, v_1, \ddd, v_N$ of $V$. If $k \in \{1, \ddd, N\}$, then
  \begin{equation}
    T v_k = T v_k - \lambda_m v_k + \lambda_m v_k = (T-\lambda_m I)v_k + \lambda_m v_k.
  \end{equation}

  The definition of $U=\myrange(T-\lambda_mI)$ shows that $(T-\lambda_mI) v_k \in U = \myspan{u_1, \ddd, u_m}.$ Thus the equation above shows that
  \begin{equation}
    \label{eq: second eq for T u_k}
    \forall k \in \{ 1, \ddd, N \}: T v_k \in \myspan{u_1, \ddd, u_m, v_1, \ddd, v_k}
  \end{equation}

  Using \ref{conditions for upper-triangular matrix} together with \eqref{eq: first eq for T v_k} and \eqref{eq: second eq for T u_k}, we conclude that $T$ has an upper-triangular matrix with respect to basis $u_1, \ddd, u_M, v_1, \ddd, v_N$ of $V$.
\end{prf}


\setcounter{thm}{46}
\begin{thm}[sufficienct condition about the field for every operator on $V$ to have an upper-triangular matrix]
  \label{thm: sufficienct condition about the field for every operator on V to have an upper-triangular matrix}
  Let $\myF = \compl$. Let $T\in \linmap (V),$ $\dim V \neq \infty$. Then $T$ has an upper-triangular matrix with respect to some basis of $V$.
\end{thm}
\begin{prf}
  This follows from \ref{thm: necessary and sufficient condition to have an upper-triangular-matrix} and the second version of the fundamental theorem of algebra \ref{fundamental-theorem-of-algebra-second-version} (?).
\end{prf}
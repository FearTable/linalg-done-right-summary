% declare how \emph{} should behave:
\DeclareEmphSequence{\scshape\bfseries}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% abbriviation for rightarrow direction and leftarrow direction:
\newcommand{\Rightarrowdirection}{\prooffont{$\Rightarrow$ direction: }}
\newcommand{\Leftarrowdirection}{\prooffont{$\Leftarrow$ direction: }}
\newcommand{\StepOne}{\prooffont{Step 1: }}
\newcommand{\StepTwo}{\prooffont{Step 2: }}
\newcommand{\StepThree}{\prooffont{Step 3: }}
\newcommand{\StepFour}{\prooffont{Step 4: }}
\newcommand{\StepFive}{\prooffont{Step 5: }}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% change operatorname font
\makeatletter
\renewcommand\operator@font{\sf}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% change enumerations to alphabetical as default
\setlist[enumerate]{itemsep=\itemsep,topsep=\itemsep}
\setlist[enumerate,1]{label=\textbf{(\alph*)}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% For item, enumerate, description, lists
\setitemize{noitemsep,topsep=0pt,parsep=0pt,partopsep=0pt}
\setenumerate{noitemsep,topsep=0pt,parsep=0pt,partopsep=0pt}
\setdescription{noitemsep,topsep=0pt,parsep=0pt,partopsep=0pt}
\setlist{noitemsep,topsep=0pt,parsep=0pt,partopsep=0pt}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% change the size of math-boxes
\setlength{\fboxsep}{.5\fboxsep}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% only displays equation numbers if they are referenced
\mathtoolsset{showonlyrefs,showmanualtags}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Nice way to write '\theorem{#theoremnumber}' or \definition{#definitionnumber'}
\newcommand{\setthm}[1]{\setcounter{thm}{#1-1}}
\newcommand{\setdef}[1]{\setcounter{thm}{#1-1}}
\newcommand{\setxmpl}[1]{\setcounter{thm}{#1-1}}
% Previously used: a short function to set a counter. 'mce' stands for make counter equal.
\newcommand{\mce}[1]{\setcounter{thm}{#1-1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% spacing inside and after math equations:
\setlength{\abovedisplayskip}{0.1em}
\setlength{\belowdisplayskip}{0em}
\setlength{\abovedisplayshortskip}{0pt}
\setlength{\belowdisplayshortskip}{0pt}
\setlength{\jot}{0pt}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\titlespacing{\chapter}{0pt}{0em}{0.4em}
\titlespacing{\section}{0pt}{1em}{0.4em} %15pt, 3pt
\titlespacing{\subsection}{0pt}{1em}{0.4em} %15pt, 3pt


% new mdframed style that places the edges at the corners (.675em):
\mdfdefinestyle{proof-style}{
  skipabove         = 0.1em,% .5\baselineskip ,
  skipbelow         = 8em,%.5\baselineskip ,
  leftmargin        = 7pt ,
  rightmargin       = 0em ,
  innermargin       = 0pt ,
  innertopmargin    = 0.5em, %0.6 %.675em ,
  innerleftmargin   = 7pt, %.675em ,
  innerrightmargin  = 0em,
  innerbottommargin = 0.5em, %.675em +3pt,
  hidealllines      = true,
  singleextra       = {
    \draw [thin] (O) -- ++(0,1.8em) (O) -- ++(1.8em,0) ;
    \draw [thin] (P-|O) -- ++(0,-1.8em) (P-|O) -- ++(1.8em,0) ;
  },
  firstextra        = {
    \draw [thin] (P-|O) -- ++(0,-1.8em) (P-|O) -- ++(1.8em,0) ;
  },
  secondextra       = {
    \draw [thin] (O) -- ++(0,1.8em) (O) -- ++(1.8em,0) ;
  },
}

\surroundwithmdframed[style=proof-style]{prf}
\newtheorem*{prf}{Proof}

% for exercises, we may be want proofs to look different:
\mdfdefinestyle{exercise-proof-style}{
  skipabove         = 0.1em,% .5\baselineskip ,
  skipbelow         = 0.5em,%.5\baselineskip ,
  leftmargin        = 7pt,
  rightmargin       = 0em ,
  innermargin       = 0pt ,
  innertopmargin    = 0.5em, %0.6 %.675em ,
  innerleftmargin   = 7pt, %.675em ,
  innerrightmargin  = 0em,
  innerbottommargin = 0.4em, %.675em +3pt,
  hidealllines      = true,
}

\surroundwithmdframed[style=exercise-proof-style]{xprf}
\newtheorem*{xprf}{Proof}

\surroundwithmdframed[style=exercise-proof-style]{xsol}
\newtheorem*{xsol}{Solution}

% custom QED Symbol
%\newcommand*\closedbox{%
%    \leavevmode\hbox to.77778em{\rule{.675em}{.675em}}}
%\let\qedsymbol\closedbox

%\renewcommand{\qedsymbol}{\rule{0.7em}{0.7em}}

\renewenvironment{prf}{{\textbf{\scshape \slshape Proof:}}}{\hfill $\qedsymbol$}
\renewenvironment{xprf}{{\textbf{\scshape \slshape Proof:}}}{\hfill $\qedsymbol$}
\renewenvironment{xsol}{{\textbf{\scshape \slshape Solution:}}}{ }

% custom command to have the same slanted font as "Proof:"
%\newcommand{\prooffont}[1]{\textbf{\scshape \slshape #1}}

% put the new mdframed style around the 'proof' and 'xmpl0 environment:
%\surroundwithmdframed[style=proof]{xmpl}

% BEGIN custom therem and proof environments ***************
\newtheoremstyle{mytheoremstyle} % name
{0.4em}                       % Space above {\topsep}
{.2em}                        % Space below
{}                            % Body font
{0em}                         % Indent amount
{}                            % Theorem head font {\ttfamily\fontseries{b}\selectfont}
{\textbf{:\,}\\}       % Punctuation after theorem head
{.2em}                        % Space after theorem head
{\underline{\textbf{\scshape{\thmname{#1}\thmnumber{ #2}}}{\normalfont \thmnote{ ({\itshape#3})}}}}

% If we ever want to use the same font as in theorem head:
\newcommand{\theoremfont}[1]{\textbf{\scshape{#1}}}

% Define 'thm', 'thm-non', 'mydef', 'mydef-non', 'example', 'example-non'
% environments

\theoremstyle{mytheoremstyle}
\newtheorem{thm}{Thm}[chapter]
\newtheorem*{thm-non}{Thm}

%\theoremstyle{mytheoremstyle}
\newtheorem{mydef}[thm]{Def}
\newtheorem*{mydef-non}{Def}

%\theoremstyle{mytheoremstyle}
\newtheorem{example}[thm]{Example}
\newtheorem*{example-non}{Example}


%% BEGIN custom therem and proof environments ***************
%\newtheoremstyle{xrcs-style} % name
%{0.4em}                       % Space above {\topsep}
%{.2em}                        % Space below
%{}                            % Body font
%{0em}                         % Indent amount
%{}                            % Theorem head font {\ttfamily\fontseries{b}\selectfont}
%{\textbf{:\,}}       % Punctuation after theorem head
%{.2em}                        % Space after theorem head
%{{\textbf{\scshape{\thmname{#1}\thmnumber{ #2}}}{\normalfont \thmnote{ ({\itshape#3})}}}}
%
%\theoremstyle{xrcs-style}
%\newtheorem{xrcs}{Exercise}[section]
%%\newtheorem*{xrcs-non}{Exercise}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Define the custom environment for exercises. %%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Define the exercise counter.
\newcounter{xrcscount}[section]

\newcommand{\exercise}[1]{\setcounter{xrcscount}{#1-1}}

\newenvironment{xrcs}{%
  % Manually step the counter.
  \refstepcounter{xrcscount}%
  % Begin a list that prints the label using our macro \thexrcs.
  % \begin{list}{\textbf{\thesection.\thexrcscount}}{%
  \begin{list}{\prooffont{\thexrcscount} \;}{%
      % Adjust these lengths to control the indentation:
      \setlength{\leftmargin}{3em}% distance from left edge to the body of the item
      %\setlength{\leftmargin}{\mathindent}% distance from left edge to the body of the item
      %\setlength{\itemindent}{0em}% ensures wrapped lines line up with the first line
      \setlength{\labelwidth}{3.5em}% space reserved for the label (adjust as needed)
      %\setlength{\labelwidth}{.3\mathindent}% space reserved for the label (adjust as needed)
      \setlength{\labelsep}{0.6em}% space between the label and the text
      \setlength{\listparindent}{0em}% paragraph indent within the list
      %\setlength{\parsep}{0pt}% vertical space between paragraphs in the item
    }%
    \item
  }{%
  \end{list}
  \vspace{.2 \baselineskip}
  \hrule
  \vspace{.2 \baselineskip}
}

% equality with text above
\newcommand\eqwtxt[1]{
\;\overset{\text{\scriptsize#1}}{=}}


% iff with text above
\newcommand\iffwtxt[1]{
  \;\overset{\text{\scriptsize#1}}{\iff}}

% implication with text above
\newcommand\implwtxt[1]{\;\overset{\text{\scriptsize#1}}{\implies}}

% we need some space around dots
\newcommand\ddd{{\, \ldots \,\,}}

% such that, s. t.
\newcommand\st{{such that }}

% quotes
\newcommand\qt[1]{\textit{``#1''}}

\newcommand{\ip}[2]{\left \langle #1 \, {\displaystyle\mathlarger,} \, #2 \right \rangle}
\newcommand{\innp}[2]{\left \langle #1, #2 \right \rangle}
\newcommand{\norm}[1]{\left \lVert #1 \right \rVert}
\newcommand{\gt}{>}
\newcommand{\lt}{<}

% May be obsolete since you can use '$' inside equation environment
\newcommand\mytext[1]{\;\;\, \text{#1}\;\;}
\newcommand\myand{\;\;\, \text{and}\;\;}
\newcommand\myor{\;\;\, \text{or}\;\;}
\newcommand\where{\;\;\, \text{where}\;\;}
\newcommand\whereEach{\;\;\, \text{where each}\;\;}
\newcommand\dx{\, dx}
\newcommand\dy{\, dy}
\newcommand\dz{\, dz}
\newcommand\du{\, du}

% BFEMPH
\newcommand{\bfemph}[1]{{\textbf{\scshape #1}}}

% natural numbers, integers, real numbers, complex numbers:
\newcommand{\nat}{\mathbb{N}}
\newcommand{\integer}{\mathbb{Z}}
\newcommand{\real}{\mathbb{R}}
\newcommand{\compl}{\mathbb{C}}
\newcommand{\myF}{\mathbb{F}}

% polynomial symbol:
\newcommand{\polyn}{\mathcal{P}}

% degree operator:
\def\degree{{\operatorname{deg} \,}}

% Matrix symbol M:
\newcommand{\mmatrix}{\mathcal{M}}

% use \span{..} for span(..)
\newcommand{\myspan}[1]{\operatorname{span} (#1)}

%Fast way to write v_1 ... v_n
\newcommand{\oneTillN}[1]{#1_1, \dots, #1_n}
\newcommand{\onetilln}[1]{#1_1, \dots, #1_n}

%Fast way to write v_1 ... v_m
\newcommand{\oneTillM}[1]{#1_1, \dots, #1_m}
\newcommand{\onetillm}[1]{#1_1, \dots, #1_m}
\newcommand{\setOneTillM}{\{ 1, \ldots, m \}}
\newcommand{\setonetillm}{\{ 1, \ldots, m \}}

% fast way to write v_1 ... v_{#2}
% usage \onetill{v}{k-1} yields v_1 \dots v_{k-1}
\newcommand{\oneTill}[2]{#1_1, \dots, #1_{#2}}
\newcommand{\onetill}[2]{#1_1, \dots, #1_{#2}}

\newcommand{\kInOneTillM}{k \in \{1, \dots, m \}} % k e {1...m}
\newcommand{\kinonetillm}{k \in \{1, \dots, m \}} % k e {1...m}
\newcommand{\kInOneTillN}{k \in \{1, \dots, n \}} % k e {1...n}
\newcommand{\kinonetilln}{k \in \{1, \dots, n \}} % k e {1...n}
\newcommand{\kInOneTillP}{k \in \{1, \dots, p \}} % k e {1...p}
\newcommand{\kinonetillp}{k \in \{1, \dots, p \}} % k e {1...p}

% abbreviation for finite-dimensional vector space
\newcommand{\findimvecpac}{finite\-/dimensional vector space }
\newcommand{\findimvs}{finite\-/dimensional vector space }
\newcommand{\fdvs}{finite\-/dimensional vector space }

% abbreviation for linearly independent
\newcommand{\lid}{linearly independent}

% abbreviation for linearly independent
\newcommand{\ld}{linearly dependent }

% abbreviation for linearly independent
\newcommand{\vs}{vector space }

% abbreviation for finite-dimensional
\newcommand{\fd}{finite\-/dimensional }

% abbreviation for linear map
\newcommand{\lm}{{linear map }}

% abbreaviation for L(V,W)
\newcommand{\lvw}{{\mathcal{L}(V,W)}}

% use \linmap for L or \lin{arg1}{arg2} for L(arg1, arg2)
\newcommand{\linmap}{\mathcal{L}}
\newcommand{\lin}[2]{{\mathcal{L}(#1, #2)}}

% null and range
\newcommand{\mynull}{\operatorname{null}}
\newcommand{\myrange}{\operatorname{range}}

% dimension
\newcommand{\mydim}{\operatorname{dim}}

% even and odd
\newcommand{\even}{\operatorname{even}}
\newcommand{\odd}{\operatorname{odd}}

% dual space
\newcommand{\dual}[1]{\displaystyle#1\mathlarger{'}}

% legacy

% \newcommand{\basis}[2]{\overbrace{ \myspan{#1_1, \dots #1_{#2}}}^{\text{linearly independent}} }}
\def\myimpl{{\{black}{\implies}}

% octave or matlab
\newcommand{\octave}[1]{

\begin{center}
  \begin{minipage}{\linewidth}

    \addtolength{\linewidth}{-7em}
    \lstinputlisting[
    aboveskip=0.7em,
    frame=single,
    numbers=left,
    style=Matlab-bw,
    basicstyle=\scriptsize\ttfamily]{octave/#1}
    \addtolength{\linewidth}{+7em}

  \end{minipage}
\end{center}

}

% real part, imagenary part
\newcommand{\realpart}{\operatorname{Re}}
\newcommand{\impart}{\operatorname{Im}}

% dashed box
\newtcbox{\dashedbox}[1][]{
  math upper,
baseline=0.4\baselineskip,
equal height group=dashedbox,
nobeforeafter,
colback=white,
boxrule=0pt,
enhanced jigsaw,
boxsep=0pt,
top=2pt,
bottom=2pt,
left=2pt,
right=2pt,
borderline horizontal={0.5pt}{0pt}{dashed},
borderline vertical={0.5pt}{0pt}{dashed},
drop lifted shadow,
#1
}

% END custom comands ***************************************

% BEGIN custom chapter format ******************************
\renewcommand*{\thechapter}{\arabic{chapter}}
\renewcommand*{\thesection}{\arabic{chapter}\Alph{section}}
\renewcommand*{\thesubsection}{\arabic{chapter}\Alph{section}\arabic{subsection}}

%\renewcommand{\thechapter}{\arabic{chapter}}
%\renewcommand{\thesection}{\thechapter\Alph{section}}
%\renewcommand{\thesubsection}{\thesection\arabic{subsection}} % e.g. 2A, 2B, etc.
%\renewcommand{\thesubsubsection}{\thesubsection\Alph{subsubsection}} % e.g. 2B1, 2B2

\titleformat{\chapter}[block]
{\bfseries\scshape}{\underline{\relscale{1.2}#1 {\footnotesize (Chapter \thechapter)}}}{0em}{\large}

\titleformat{\section}{\relscale{1.1}\bfseries\scshape}{}{0em}{\underline{#1 {\footnotesize(Section  \thesection)}}}[]

\titleformat{name=\section,numberless}
[runin] % shape
{\relscale{1.1}\bfseries\scshape} % format
{} % label
{0em} % sep
{} % before-code
[\underline{#1 \thesection}] % after-code

\titleformat{\subsection}{\relscale{1.1}\bfseries\scshape}{}{0em}{\underline{#1 {\footnotesize (Sub-Section \thesubsection)}}} %large
% END custom chapter format ********************************